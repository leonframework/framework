<html>
<head>
    <title>Comet Ping test</title>
    <script src="/leon/leon.js?loadAngular=false" type="text/javascript"></script>
    <script type="text/javascript">
	    $(function() {
	        getLeon().subscribeTopic("ping", function(data) {
                $("#status").text(data);
	        });

	        $("#sendPing").click(function() {
				var count = 0;
			    (function send50Pings() {
	                if (getLeon().comet.isCometActive()) {
			            getLeon().service("/pingService", "ping").call();
			            count = count + 1;
	                }
			        if (count < 50) {
		                setTimeout(function() { send50Pings() }, 100);
			        }
			    })();
	        });

	        $("#status").text("init");
	    });
    </script>
</head>

<body>
<div>
    <h1>Comet Ping example</h1>
    <hr />

    <a id="sendPing" href="#">Send ping to server</a>
    <br/>

    <h2>Status</h2>
    <div id="status"></div>
</div>
</body>
</html>
