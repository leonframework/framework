<!doctype html>
<html xmlns:ng="http://angularjs.org" xmlns:ngm="http://github.com/tigbro/jquery-mobile-angular-adapter">

<html class="ui-mobile landscape">

  <head>
    <title>---------Leon Rocks On Mobile!-----------</title>
    <#include "/io/leon/templates/full.mobile.html" />
    <script src="browser/controllers.js" type="text/javascript"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript">
       function handleMessage(msg) {
          $("#messages").prepend("<div class='message'>" + msg + "</div>");
       }
     </script>
  </head>

  <body class="ui-mobile-viewport" ng:controller="LeonJaxCtrl">

    <leon:subscribe topic="messages" filterOn="room" handlerFn="handleMessage"/>

    <!-------------------------- page1 -------------------------->
    <div data-role="page" id="page1" data-title="Enter your name...">
      <!------ header ------>
      <div data-role="header">
        <h1>Leon JAX Mobile</h1>
        <pre>data={{user}}</pre>
      </div>
      <!------ content ------>
      <div data-role="content">
        <div data-role="fieldcontain">
          <label for="name">Your name:</label>
          <input id="name" type="text" name="user.name"/>
        </div>
        <a href="#page2" data-role="button" data-inline="false">Go!</a>
      </div>
      <!------ footer ------>
      <div data-role="footer">
        <h4>&copy; 2011 by Weigle Wilczek GmbH</h4>
      </div>
    </div>

    <!-------------------------- page2 -------------------------->
    <div data-role="page" id="page2">
      <!------ header ------>
      <div data-role="header">
        <h1>Leon JAX Mobile</h1>
        <pre>messages={{messages}}</pre>
        <pre>user={{user}}</pre>
      </div>
      <!------ content ------>
      <div data-role="content">
        <h2>Hello {{user.name}}!</h2>
        <div data-role="fieldcontain">
          <label for="room">Room</label>
          <select id="room" name="user.room" ng:options="r.name for r in rooms" data-native-menu="false" tabindex="-1">
            <option value="" data-placeholder="true">-- select room --</option>
          </select>
        </div>
        <div>
          <label for="message">Compose Message:</label>
          <textarea id="message" name="message"></textarea>
          <a ngm:click="postMessage(message)" ng:disabled="{{user.name.length == 0 || message.length == 0 || user.room == null}}" data-role="button" data-inline="false">Submit</a>
        </div>
        <div id="messages">
          <!--
          <div ng:repeat="message in messages">
            {{message}}
          </div>
          -->
        </div>
      </div>
      <!------ footer ------>
      <div data-role="footer">
        <h4>&copy; 2011 by Weigle Wilczek GmbH</h4>
      </div>
    </div>
  </body>
</html>
